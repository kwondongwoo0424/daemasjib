import{q as D,o as v,w as n,c as A,g as p,d as u,a as y,T as c,u as w,f,b as o,e as g}from"./index-q4K3aoHI.js";const r="visits",h={async createVisit(e){const t=c.now();return(await g(A(o,r),{...e,visitedAt:c.fromDate(e.visitedAt),createdAt:t,updatedAt:t})).id},async getVisitsByUserId(e){try{const t=D(A(o,r),n("userId","==",e));return(await p(t)).docs.map(s=>{const a=s.data();return{id:s.id,...a,visitedAt:a.visitedAt?.toDate?a.visitedAt.toDate():new Date(a.visitedAt),createdAt:a.createdAt?.toDate?a.createdAt.toDate():new Date(a.createdAt),updatedAt:a.updatedAt?.toDate?a.updatedAt.toDate():new Date(a.updatedAt)}}).sort((s,a)=>a.visitedAt.getTime()-s.visitedAt.getTime())}catch(t){throw console.error("[Visit Debug] Error fetching visits:",t),t}},async getVisitById(e){const t=u(o,r,e),d=await f(t);if(!d.exists())return null;const i=d.data();return{id:d.id,...i,visitedAt:i.visitedAt.toDate(),createdAt:i.createdAt.toDate(),updatedAt:i.updatedAt.toDate()}},async updateVisit(e,t){const d=u(o,r,e),i={...t,updatedAt:c.now()};t.visitedAt&&(i.visitedAt=c.fromDate(t.visitedAt)),await w(d,i)},async deleteVisit(e){const t=u(o,r,e);await y(t)},async getVisitsByRestaurant(e,t){const d=D(A(o,r),n("userId","==",e),n("restaurantId","==",t),v("visitedAt","desc"));return(await p(d)).docs.map(s=>({id:s.id,...s.data(),visitedAt:s.data().visitedAt.toDate(),createdAt:s.data().createdAt.toDate(),updatedAt:s.data().updatedAt.toDate()}))}};export{h as visitService};
