import{q as p,w as c,c as n,g as i,d as y,a as k,b as o,o as g,e as w,T as A,u as I}from"./index-q4K3aoHI.js";const m="bookmark_groups",u="bookmarks",q={async createGroup(t,e){const r=A.now();return(await w(n(o,m),{userId:t,groupName:e,createdAt:r,updatedAt:r})).id},async createBookmarkGroup(t){return this.createGroup(t.userId,t.groupName)},async getGroupsByUserId(t){const e=p(n(o,m),c("userId","==",t),g("createdAt","desc"));return(await i(e)).docs.map(a=>({id:a.id,...a.data(),createdAt:a.data().createdAt.toDate(),updatedAt:a.data().updatedAt.toDate()}))},async getBookmarkGroups(t){return this.getGroupsByUserId(t)},async updateGroupName(t,e){const r=y(o,m,t);await I(r,{groupName:e,updatedAt:A.now()})},async deleteGroup(t){const e=p(n(o,u),c("groupId","==",t)),a=(await i(e)).docs.map(s=>k(s.ref));await Promise.all(a);const d=y(o,m,t);await k(d)},async addBookmark(t){return(await w(n(o,u),{userId:t.userId,groupId:t.groupId,restaurantId:t.restaurantId,restaurantName:t.restaurantName,restaurantAddress:t.restaurantAddress,createdAt:A.now()})).id},async getBookmarksByGroupId(t){const e=p(n(o,u),c("groupId","==",t),g("createdAt","desc"));return(await i(e)).docs.map(a=>({id:a.id,...a.data(),createdAt:a.data().createdAt.toDate()}))},async getBookmarksByUserId(t){try{const e=p(n(o,u),c("userId","==",t));return(await i(e)).docs.map(d=>{const s=d.data();return{id:d.id,...s,createdAt:s.createdAt?.toDate?s.createdAt.toDate():new Date(s.createdAt)}}).sort((d,s)=>s.createdAt.getTime()-d.createdAt.getTime())}catch(e){throw console.error("[Bookmark Debug] Error fetching bookmarks:",e),e}},async deleteBookmark(t){const e=y(o,u,t);await k(e)},async checkBookmarkExists(t,e,r){const a=p(n(o,u),c("userId","==",t),c("restaurantId","==",e),c("groupId","==",r));return!(await i(a)).empty}};export{q as bookmarkService};
